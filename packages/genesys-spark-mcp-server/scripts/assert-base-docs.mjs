#!/usr/bin/env node

import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __dirname = path.dirname(fileURLToPath(import.meta.url));

/**
 * Assert that the required json-docs.json file exists and can be imported.
 * This file is generated by the build process in genesys-spark-components.
 */

function assertBaseDocsExist() {
    try {
        const jsonDocsPath = path.resolve(__dirname, '../src/data/json-docs.json');
        
        // Read and parse the JSON file
        const fileContent = fs.readFileSync(jsonDocsPath, 'utf8');
        const data = JSON.parse(fileContent);
        
        if (!data || !data.components || data.components.length === 0) {
            throw new Error('json-docs.json exists but is empty or invalid');
        }
        
        console.log('‚úÖ json-docs.json successfully imported');
        console.log(`   üìä Found ${data.components.length} components`);
        if (data.sourceMetadata) {
            console.log(`   üì¶ Source: ${data.sourceMetadata.package}@${data.sourceMetadata.version}`);
        }
    } catch (error) {
        console.error('‚ùå Error: Failed to load json-docs.json from data folder');
        console.error('');
        console.error('üîß To resolve this issue:');
        console.error('   1. Navigate to the genesys-spark-components package');
        console.error('   2. Run the build script to generate json-docs.json:');
        console.error('      cd packages/genesys-spark-components && npm run build');
        console.error('');
        console.error('   Error details:', error.message);
        process.exit(1);
    }
}

assertBaseDocsExist();